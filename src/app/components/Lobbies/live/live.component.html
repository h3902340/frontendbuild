<section class="one-column-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div *ngIf="matchArray" class="game-count">
                    <p>Last Update: {{lastUpdateDateString}}&nbsp;&nbsp;&nbsp;&nbsp;Game Count: {{gameCount}}</p>
                </div>
                <div class="row align-items-end">
                    <div class="col-lg-2">
                        <h2 class="main-heading" style="white-space: nowrap;">Live</h2>
                    </div>
                    <div class="col-lg-7">
                        <div style="margin-left: 40px;">
                            <mat-slider class="width-100pc" discrete showTickMarks step="100" min="0" max="2500">
                                <input value="0" matSliderStartThumb [(ngModel)]="eloLowerBound">
                                <input value="2500" matSliderEndThumb [(ngModel)]="eloUpperBound">
                            </mat-slider>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="game-mode-select dark-bg-no-shadow">
                            <label for="game-mode">Game Mode</label>
                            <select class="form-select" id="game-mode" [(ngModel)]="selectedGameMode">
                                <option value=-1 selected>All</option>
                                <option value=0>Lobby</option>
                                <option value=1>Sup Solo</option>
                                <option value=2>Sup Team</option>
                                <option value=3>DM</option>
                                <option value=4>Treaty</option>
                                <option value=5>EW Solo</option>
                                <option value=6>EW Team</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="tab-content dark-bg-no-shadow" id="myTabContent">
                    <div class="table-responsive">
                        <table class="table table-dark table-striped noborder-table">
                            <thead>
                                <tr>
                                    <th class="light-th-center" scope="col">Game Name</th>
                                    <th class="light-th-center" scope="col">Game Mode</th>
                                    <th class="light-th-right" scope="col">Players</th>
                                    <th class="light-th-center" scope="col"></th>
                                    <th class="light-th-center" scope="col">Start Date</th>
                                    <th class="light-th-center" scope="col">Link</th>
                                </tr>
                            </thead>
                            <tbody id="observable-table">
                                <ng-container *ngFor="let match of matchArrayPaginated; trackBy: trackMatch">
                                    <tr>
                                        <td style="text-align: center;" scope="row">{{match.gameName}}</td>
                                        <td style="text-align: center;" scope="row">{{gameModeToName[match.gameMode]}}
                                        </td>
                                        <td style="text-align: left">
                                            <ng-container *ngFor="let team of match.teamList | keyvalue; let i = index">
                                                <ng-container *ngIf="i % 2 == 0">
                                                    <mat-divider *ngIf="i > 1 " class="divider"></mat-divider>
                                                    <div *ngFor="let player of team.value">
                                                        <div *ngIf="player.idPlayer == -1; else elseBlock">
                                                            <img class="flag" [src]="player.civFlagUrl">{{player.name}} {{player.eloString }}
                                                        </div>
                                                        <ng-template #elseBlock>
                                                            <a [routerLink]="['/profile']"
                                                                [queryParams]="{idPlayer: player.idPlayer}"
                                                                style="color: aliceblue;">
                                                                <img class="flag"
                                                                    [src]="player.civFlagUrl">{{player.name}} {{player.eloString }}
                                                            </a>
                                                        </ng-template>
                                                    </div>
                                                </ng-container>
                                            </ng-container>
                                        </td>
                                        <td style="text-align: left">
                                            <ng-container *ngFor="let team of match.teamList | keyvalue; let i = index">
                                                <ng-container *ngIf="i % 2 != 0">
                                                    <mat-divider *ngIf="i> 2 " class="divider"></mat-divider>
                                                    <div *ngFor="let player of team.value">
                                                        <div *ngIf="player.idPlayer == -1; else elseBlock">
                                                            <img class="flag" [src]="player.civFlagUrl">{{player.name}} {{player.eloString }}
                                                        </div>
                                                        <ng-template #elseBlock>
                                                            <a [routerLink]="['/profile']"
                                                                [queryParams]="{idPlayer: player.idPlayer}"
                                                                style="color: aliceblue;">
                                                                <img class="flag"
                                                                    [src]="player.civFlagUrl">{{player.name}} {{player.eloString }}
                                                            </a>
                                                        </ng-template>
                                                    </div>
                                                </ng-container>
                                            </ng-container>
                                        </td>
                                        <td style="text-align: center;">{{match.agoString}}</td>
                                        <td style="text-align: center;">
                                            <ng-container>
                                                <button mat-icon-button [cdkCopyToClipboard]="match.idGame.toString()"
                                                    matTooltip="Copied to clipboard!" #tooltip="matTooltip"
                                                    (mouseenter)="$event.stopImmediatePropagation()"
                                                    (mouseleave)="tooltip.hide();" (click)="tooltip.show();">
                                                    <mat-icon>content_copy</mat-icon>
                                                </button>
                                            </ng-container>
                                        </td>
                                    </tr>
                                </ng-container>
                            </tbody>
                        </table>
                        <!-- Pagination -->
                        <div class="navigation-panel-wrapper">
                            <div class="control-panel">
                                <ul>
                                    <li>
                                        <button type="button" class="ctrl-btn" (click)="firstPage()"><i
                                                class="fa-solid fa-backward-step"></i></button>
                                    </li>
                                    <li>
                                        <button type="button" class="ctrl-btn reverse" (click)="previousPage()"><i
                                                class="fa-solid fa-play "></i></button>
                                    </li>
                                    <li><input type="number" min="1" oninput="validity.valid||(value='');" [(ngModel)]="pagePlusOne"
                                            class="ctrl-input" (keyup.enter)="goToPage()"></li>
                                    <li>
                                        <button type="button" class="ctrl-btn" (click)="nextPage()"><i class="fa-solid fa-play"></i></button>
                                    </li>
                                    <li>
                                        <button type="button" class="ctrl-btn" (click)="lastPage()"><i
                                                class="fa-solid fa-forward-step"></i></button>
                                    </li>
                                </ul>
                            </div>
                            <div class="number-pages">
                                {{showPage}} of {{showPageMax}} pages
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>